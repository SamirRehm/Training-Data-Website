---
title: "Training Statistics"
author: "Samir Rehmtulla"
date: "February 26, 2018"
output: 
  html_document:
    keep_md: true
always_allow_html: yes
---

```{r, echo = FALSE}
load(file = "Data.RData")
```

```{r setup, include=FALSE}
library(lubridate)
library(plotly)
library(stringr)
library(plyr)
library(sp)
library(googleway)
library(webshot)
knitr::opts_chunk$set(echo = TRUE)
load("Data.RData")
```

## Week `r weekOfPlan` Advanced Statistics


### Steady State Workouts
```{r advancedStats, echo=FALSE, warning=FALSE, results='asis'}
plots <- htmltools::tagList()

RunningWeek <- RunningDataList[[weekOfPlan]]
SteadyRuns <- RunningWeek[RunningWeek$RunType == "Steady",]
for(i in 1:nrow(SteadyRuns)) {
  p <- plot_ly(SteadyRuns, x = SteadyRuns$TimeStreams[[i]]/60, y = SteadyRuns$VelocityStreams[[i]], type = "scatter", mode = "lines+markers", name = "Raw Data")
  smooth <- smooth.spline(SteadyRuns$TimeStreams[[i]]/60, SteadyRuns$VelocityStreams[[i]], spar = 1)
  smoothData <- data.frame(smooth$x, smooth$y)
  p <- p %>% add_trace(smoothData, x=smoothData$smooth.x, y=smoothData$smooth.y, name = 'Smoothened Data')
  plots[[i]] <- list(as_widget(p), paste("Steady Score:", signif((1 - (1/(1+exp(-17* (sd(smoothData$smooth.y) -0.25))))) * 100, 2), "%"))
}
plots

```
